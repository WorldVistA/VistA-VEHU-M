SDEC745P ;ALB/CLT - PATCH 745 POST INSTALL ROUTINE ;Jun 10, 2020@1:44
 ;;5.3;SCHEDULING;**745**;AUG 13, 1993;Build 40
 ;
FIND ;FIND THE IEN FOR "VS GUI NATIONAL"
 N SDECDA,SDECDA1,SDECLNK
 W !!?3,"Updating SDEC SETTINGS file (#409.98)",!!
 S SDECDA=0,SDECDA=$O(^SDEC(409.98,"B","VS GUI NATIONAL",SDECDA)) G:$G(SDECDA)="" NOFIND
 D VERSION   ;update GUI version number and date
 S SDECDA1=0,SDECDA1=$O(^SDEC(409.98,1,1,"B","OIT Helpdesk - (855) 673-4357",SDECDA1))
 I $G(SDECDA1)="" G XIT  ; did not find cross-reference
 D RMOVE,ADD G XIT
RMOVE ;REMOVE OLD ENTRY
 K ^SDEC(409.98,SDECDA,1,"B",$E($P(^SDEC(409.98,SDECDA,1,SDECDA1,0),U,1),1,30),SDECDA1)
 Q
ADD ;ADD UPDATED ENTRY
 S SDECLNK="VA Enterprise Service Desk (ESD) (855) 673-4357"
 S $P(^SDEC(409.98,SDECDA,1,SDECDA1,0),U,1)=SDECLNK
 S ^SDEC(409.98,SDECDA,1,"B",$E(SDECLNK,1,30),SDECDA1)=""   ;cross-reference is first 30 characters
 Q
VERSION ;SET THE NEW VERSION UPDATE IN SDEC SETTING FILE #409.98 TO 1.7.1
 S DA=SDECDA,DIE=409.98,DR="2///1.7.1 R1;3///3200623" D ^DIE  ;update VS GUI NATIONAL
 K DIE,DR,DA
 S SDECDA2=0,SDECDA2=$O(^SDEC(409.98,"B","VS GUI LOCAL",SDECDA2)) Q:$G(SDECDA2)=""    ;get DA for the VS GUI LOCAL
 S DA=SDECDA2,DIE=409.98,DR="2///1.7.1 R1;3///3200623" D ^DIE  ;update VS GUI LOCAL
 K DIE,DR,DA
 Q
NOFIND ;"VS GUI NATIONAL" NOT FOUND
 W !!?3,"VS GUI NATIONAL not found in the SDEC SETTINGS file (#409.98)"
XIT ;EXIT ROUTINE
 ;
 Q
