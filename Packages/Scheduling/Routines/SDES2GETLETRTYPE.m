SDES2GETLETRTYPE ;ALB/BLB - VISTA SCHEDULING RPCS ;Feb 16, 2025@8:00am
 ;;5.3;Scheduling;**901**;Aug 13, 1993;Build 7
 ;;Per VHA Directive 6402, this routine should not be modified
 ;
 Q
 ;
GETLETTERTYPES(JSON,SDCONTEXT) ;
 N ERRORS,LETTERTYPES
 ;
 D VALCONTEXT^SDES2VALCONTEXT(.ERRORS,.SDCONTEXT)
 I $D(ERRORS) S ERRORS("letterTypes",1)="" D BUILDJSON^SDES2JSON(.JSON,.ERRORS) Q
 ;
 D GETTYPES(.LETTERTYPES)
 D BUILDJSON^SDESBUILDJSON(.JSON,.LETTERTYPES)
 Q
 ;
GETTYPES(LETTERTYPES) ;
 N TYPE,TYPEIEN,COUNT
 ;
 S TYPE="",COUNT=0
 F  S TYPE=$O(^VA(407.5,"C",TYPE)) Q:TYPE=""  D
 .I $$GET1^DIQ(407.6,$O(^VA(407.6,"B",TYPE,"")),2,"I") Q
 .;
 .S COUNT=COUNT+1
 .S LETTERTYPES("letterTypes",COUNT,"type")=TYPE
 I '$D(LETTERTYPES) S LETTERTYPES("letterTypes",1)=""
 Q
 ;
