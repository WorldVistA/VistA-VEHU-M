IBECECU2 ;ALB/CLT - SECONDARY INPUT OF DSP DATA ; 08 Jul 2022  9:25 AM
 ;;2.0;INTEGRATED BILLING;**704**;21-MAR-94;Build 49
 ;Per VA Directive 6402, this routine should not be modified.
 ;
 ;
 Q
EN(IBCLDT1,DFN) ;ENTRY POINT FOR ADDING ENTRIES TO 351.3
 ;Create a new entry in file 351.3
 N DIC,IBFDA,IEN,IBIENS,X,Y,IEN3513,IBERR,IB351DA,DIE,DA,DR,IBREFNUM
 S DIC="^IBE(351.3,",DIC(0)=""
 S IB351DA=$O(^IBE(351,"AIVDT",DFN,-IBCLDT1,";"),-1) Q:'IB351DA
 S IBREFNUM=$P(^IBE(351,IB351DA,0),U)
 S DA=$O(^IBE(351.3,"B",IBREFNUM,0))
 I +DA=0 S X=IBREFNUM D FILE^DICN S DA=$P(Y,U,1)
 S DIE=DIC,DR=".02////^S X=DFN" D ^DIE
 D NEWSUB
 Q
NEWSUB ;Create and Load new sub-file entry
 ;S DA(1)=DA
 ;S DIC=DIC_DA(1)_",1,"
 ;S DIC(0)="L"
 ;S X=IBCLDA
 ;D ^DIC S DA=+Y
 I IBISTAT=1 S IBISTAT="CU"
 S IBIENS="+1,"_DA_","
 S IBFDA(351.31,IBIENS,.01)=IBCLDA
 S:$G(IBICLDT)'="" IBFDA(351.31,IBIENS,.02)=IBICLDT
 S:$G(IBISTAT)'="" IBFDA(351.31,IBIENS,.03)=IBISTAT
 S:$G(IBI901)'="" IBFDA(351.31,IBIENS,.04)=IBI901
 S:$G(IBI902)="" IBFDA(351.31,IBIENS,.05)=IBI902
 S:$G(IBI903)'="" IBFDA(351.31,IBIENS,.06)=IBI903
 S:$G(IBI904)'="" IBFDA(351.31,IBIENS,.07)=IBI904
 S:$G(IBICLDAY)'="" IBFDA(351.31,IBIENS,.08)=IBICLDAY
 S:$G(IBICKDT)'="" IBFDA(351.31,IBIENS,.09)=IBICKDT
 S:$G(IBISITE)'="" IBFDA(351.31,IBIENS,10)=IBISITE
 D UPDATE^DIE(,"IBFDA","IBERR")
 Q
